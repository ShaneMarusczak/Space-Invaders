"use strict";(()=>{let canFire=!0,gameStarted=!1,gameOver=!1,numberOfEnemies=0,destroyedEnemies=0,shotsFired=0,shipSpeed=1;const height=25,ship=document.getElementById("ship");function alertModalControl(message,duration){document.getElementById("alertshader").style.display="block",document.getElementById("alertmessage").innerText=message,sleep(duration).then(()=>{document.getElementById("alertshader").style.display="none"})}function sleep(ms){return new Promise(resolve=>setTimeout(resolve,ms))}function shipControl(e){if(gameStarted&&!gameOver){const posLeft=ship.offsetLeft-document.getElementById("gameBoard").offsetLeft-1;if("37"==e.keyCode&&posLeft-25>=0)ship.style.marginLeft=posLeft-25+"px",e.preventDefault();else if("39"==e.keyCode&&posLeft+25<=document.getElementById("gameBoard").offsetWidth-100)ship.style.marginLeft=posLeft+25+"px",e.preventDefault();else if("32"==e.keyCode&&canFire){shotsFired++,canFire=!1,sleep(500).then(()=>{canFire=!0});const laser=document.createElement("div");laser.classList.add("laser"),laser.style.left=ship.offsetLeft+45+"px",laser.style.top=ship.offsetTop-30+"px",ship.appendChild(laser),fireLaser(laser,ship),e.preventDefault()}}}function colides(obj1,obj2){return!(obj2.offsetLeft>obj1.offsetWidth+obj1.offsetLeft||obj1.offsetLeft>obj2.offsetWidth+obj2.offsetLeft||obj2.offsetTop>obj1.offsetHeight+obj1.offsetTop||obj1.offsetTop>obj2.offsetHeight+obj2.offsetTop)}function gameOverHandler(message){gameOver=!0,alertModalControl(message,2e3),Array.from(document.getElementsByClassName("laser")).forEach(l=>l.remove()),document.getElementById("shotsFired").innerText="Shots Fired: "+shotsFired,document.getElementById("accuracy").innerText="Accuracy: "+Math.floor(destroyedEnemies/shotsFired*100)+"%"}function fireLaser(laser,ship){const interval=175,iterations=28;for(let i=0;i<28;i++)sleep(175*i).then(()=>{laser.style.top=ship.offsetTop-50-25*i+"px",Array.from(document.getElementsByClassName("enemyShip")).forEach(es=>{colides(es,laser)&&(laser.remove(),es.remove(),destroyedEnemies++,destroyedEnemies===numberOfEnemies&&gameOverHandler("You Win!"))})});sleep(4900).then(()=>laser.remove())}function startGame(){gameStarted||(alertModalControl("Start!",1500),gameStarted=!0,sleep(1500).then(moveEnemyShipsRight))}function moveEnemyShipsDown(){shipSpeed++,Array.from(document.getElementsByClassName("enemyShip")).forEach(es=>{es.style.marginTop=Number(es.style.marginTop.substring(0,es.style.marginTop.length-2))+25+"px"})}const test=document.getElementById("gameBoard").offsetWidth+document.getElementById("gameBoard").offsetLeft;function lossChecker(){Array.from(document.getElementsByClassName("enemyShip")).some(es=>es.offsetTop+30>=ship.offsetTop)&&gameOverHandler("You Lose!")}function moveEnemyShipsRight(){if(!gameOver){if(Array.from(document.getElementsByClassName("enemyShip")).some(es=>es.offsetLeft+25+75>=test))return moveEnemyShipsDown(),lossChecker(),void sleep(375-14*shipSpeed).then(moveEnemyShipsLeft);Array.from(document.getElementsByClassName("enemyShip")).forEach(es=>{es.style.marginLeft=Number(es.style.marginLeft.substring(0,es.style.marginLeft.length-2))+25+"px"}),sleep(375-14*shipSpeed).then(moveEnemyShipsRight)}}function moveEnemyShipsLeft(){if(!gameOver){if(Array.from(document.getElementsByClassName("enemyShip")).some(es=>es.offsetLeft-25<=document.getElementById("gameBoard").offsetLeft))return moveEnemyShipsDown(),lossChecker(),void sleep(375-14*shipSpeed).then(moveEnemyShipsRight);Array.from(document.getElementsByClassName("enemyShip")).forEach(es=>{es.style.marginLeft=Number(es.style.marginLeft.substring(0,es.style.marginLeft.length-2))-25+"px"}),sleep(375-14*shipSpeed).then(moveEnemyShipsLeft)}}const imageStore=["images/enemy-4.png","images/enemy-2.png","images/enemy-3.png","images/enemy-1.png"];(()=>{for(let i=1;i<5;i++){const shipImgToUse=imageStore[i-1];for(let j=1;j<8;j++){const enemyShip=document.createElement("div"),shipImg=document.createElement("img");shipImg.src=shipImgToUse,shipImg.classList.add("enemyShipImg"),enemyShip.appendChild(shipImg),enemyShip.classList.add("enemyShip"),enemyShip.style.top=60*i+document.getElementById("gameBoard").offsetTop+"px",enemyShip.style.left=120*j+document.getElementById("gameBoard").offsetLeft+"px",document.getElementById("enemies").appendChild(enemyShip),numberOfEnemies++}}document.addEventListener("keydown",shipControl),document.getElementById("start").addEventListener("click",startGame),document.getElementById("reload").addEventListener("click",()=>location.reload())})()})();