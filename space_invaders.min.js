"use strict";(()=>{let canFire=!0,gameStarted=!1,gameOver=!1,numberOfEnemies=0,destroyedEnemies=0;const height=25;function alertModalControl(message,duration){document.getElementById("alertshader").style.display="block",document.getElementById("alertmessage").innerText=message,sleep(duration).then(()=>{document.getElementById("alertshader").style.display="none"})}function sleep(ms){return new Promise(resolve=>setTimeout(resolve,ms))}function shipControl(e){if(gameStarted&&!gameOver){const ship=document.getElementById("ship"),posLeft=ship.offsetLeft-document.getElementById("gameBoard").offsetLeft-1;if("37"==e.keyCode&&posLeft-25>=0)ship.style.marginLeft=posLeft-25+"px",e.preventDefault();else if("39"==e.keyCode&&posLeft+25<=document.getElementById("gameBoard").offsetWidth-100)ship.style.marginLeft=posLeft+25+"px",e.preventDefault();else if("32"==e.keyCode&&canFire){canFire=!1,sleep(500).then(()=>{canFire=!0});const laser=document.createElement("div");laser.classList.add("laser"),laser.style.left=ship.offsetLeft+45+"px",laser.style.top=ship.offsetTop-30+"px",ship.appendChild(laser),fireLaser(laser,ship),e.preventDefault()}}}function colides(x1,y1,w1,h1,x2,y2,w2,h2){return!(x2>w1+x1||x1>w2+x2||y2>h1+y1||y1>h2+y2)}function gameOverHandler(){gameOver=!0,alertModalControl("Game Over!",2e3),Array.from(document.getElementsByClassName("laser")).forEach(l=>l.remove())}function fireLaser(laser,ship){const interval=200,iterations=28;for(let i=0;i<28;i++)sleep(200*i).then(()=>{laser.style.top=ship.offsetTop-50-25*i+"px",Array.from(document.getElementsByClassName("enemyShip")).forEach(es=>{colides(es.offsetLeft,es.offsetTop,es.offsetWidth,es.offsetHeight,laser.offsetLeft,laser.offsetTop,laser.offsetWidth,laser.offsetHeight)&&(laser.remove(),es.remove(),destroyedEnemies++,destroyedEnemies===numberOfEnemies&&gameOverHandler())})});sleep(5600).then(()=>laser.remove())}function startGame(){gameStarted||(alertModalControl("Start!",1500),gameStarted=!0,sleep(1500).then(moveEnemyShipsRight))}function moveEnemyShipsDown(){Array.from(document.getElementsByClassName("enemyShip")).forEach(es=>{es.style.marginTop=Number(es.style.marginTop.substring(0,es.style.marginTop.length-2))+25+"px"})}const test=document.getElementById("gameBoard").offsetWidth+document.getElementById("gameBoard").offsetLeft;function moveEnemyShipsRight(){if(!gameOver){if(Array.from(document.getElementsByClassName("enemyShip")).some(es=>es.offsetLeft+25+75>=test))return moveEnemyShipsDown(),void sleep(350).then(moveEnemyShipsLeft);Array.from(document.getElementsByClassName("enemyShip")).forEach(es=>{es.style.marginLeft=Number(es.style.marginLeft.substring(0,es.style.marginLeft.length-2))+25+"px"}),sleep(350).then(moveEnemyShipsRight)}}function moveEnemyShipsLeft(){if(!gameOver){if(Array.from(document.getElementsByClassName("enemyShip")).some(es=>es.offsetLeft-25<=document.getElementById("gameBoard").offsetLeft))return moveEnemyShipsDown(),void sleep(350).then(moveEnemyShipsRight);Array.from(document.getElementsByClassName("enemyShip")).forEach(es=>{es.style.marginLeft=Number(es.style.marginLeft.substring(0,es.style.marginLeft.length-2))-25+"px"}),sleep(350).then(moveEnemyShipsLeft)}}(()=>{for(let i=1;i<5;i++)for(let j=1;j<8;j++){const enemyShip=document.createElement("div");enemyShip.classList.add("enemyShip"),enemyShip.style.top=60*i+document.getElementById("gameBoard").offsetTop+"px",enemyShip.style.left=120*j+document.getElementById("gameBoard").offsetLeft+"px",document.getElementById("enemies").appendChild(enemyShip),numberOfEnemies++}document.addEventListener("keydown",shipControl),document.getElementById("start").addEventListener("click",startGame)})()})();