const maxFireworks=5,maxSparks=50,canvas=document.getElementById("myCanvas"),context=canvas.getContext("2d"),fireworks=[];for(let a=0;a<maxFireworks;a++){const d={sparks:[]};for(let b=0;b<maxSparks;b++){const c={blue:Math.floor(2*Math.random()),green:Math.floor(2*Math.random()),red:Math.floor(2*Math.random()),vx:5*Math.random()+.5,vy:5*Math.random()+.5,weight:.3*Math.random()+.03};.5<Math.random()&&(c.vx=-c.vx);.5<Math.random()&&(c.vy=-c.vy);d.sparks.push(c)}fireworks.push(d);resetFirework(d)}window.requestAnimationFrame(explode);
function resetFirework(a){a.x=Math.floor(Math.random()*canvas.width);a.y=canvas.height;a.age=0;a.phase="fly"}
function explode(){context.clearRect(0,0,canvas.width,canvas.height);fireworks.forEach((a,d)=>{if("explode"===a.phase)a.sparks.forEach(b=>{for(let f=0;10>f;f++){var c=a.age+f;const g=a.x+b.vx*c;c=a.y+b.vy*c+b.weight*c*b.weight*c;var e=20*f-2*a.age;const h=Math.floor(b.red*e),k=Math.floor(b.green*e);e=Math.floor(b.blue*e);context.beginPath();context.fillStyle="rgba("+h+","+k+","+e+",1)";context.rect(g,c,4,4);context.fill()}}),a.age++,100<a.age&&.05>Math.random()&&resetFirework(a);else{a.y-=10;for(let b=
0;15>b;b++)context.beginPath(),context.fillStyle="rgba("+50*d+","+17*b+",0,1)",context.rect(a.x+Math.random()*b-b/2,a.y+4*b,4,4),context.fill();if(.001>Math.random()||200>a.y)a.phase="explode"}});window.requestAnimationFrame(explode)};
