"use strict";const maxFireworks=5,maxSparks=50,canvas=document.getElementById("myCanvas"),context=canvas.getContext("2d"),fireworks=[];for(let i=0;i<5;i++){const firework={sparks:[]};for(let n=0;n<50;n++){const spark={blue:Math.floor(2*Math.random()),green:Math.floor(2*Math.random()),red:Math.floor(2*Math.random()),vx:5*Math.random()+.5,vy:5*Math.random()+.5,weight:.3*Math.random()+.03};Math.random()>.5&&(spark.vx=-spark.vx),Math.random()>.5&&(spark.vy=-spark.vy),firework.sparks.push(spark)}fireworks.push(firework),resetFirework(firework)}function resetFirework(firework){firework.x=Math.floor(Math.random()*canvas.width),firework.y=canvas.height,firework.age=0,firework.phase="fly"}function explode(){context.clearRect(0,0,canvas.width,canvas.height),fireworks.forEach((firework,index)=>{if("explode"==firework.phase)firework.sparks.forEach(spark=>{for(let i=0;i<10;i++){const trailAge=firework.age+i,x=firework.x+spark.vx*trailAge,y=firework.y+spark.vy*trailAge+spark.weight*trailAge*spark.weight*trailAge,fade=20*i-2*firework.age,r=Math.floor(spark.red*fade),g=Math.floor(spark.green*fade),b=Math.floor(spark.blue*fade);context.beginPath(),context.fillStyle="rgba("+r+","+g+","+b+",1)",context.rect(x,y,4,4),context.fill()}}),firework.age++,firework.age>100&&Math.random()<.05&&resetFirework(firework);else{firework.y=firework.y-10;for(let spark=0;spark<15;spark++)context.beginPath(),context.fillStyle="rgba("+50*index+","+17*spark+",0,1)",context.rect(firework.x+Math.random()*spark-spark/2,firework.y+4*spark,4,4),context.fill();(Math.random()<.001||firework.y<200)&&(firework.phase="explode")}}),window.requestAnimationFrame(explode)}window.requestAnimationFrame(explode);